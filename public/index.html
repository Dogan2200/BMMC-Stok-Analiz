<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AVESORO BI – Excel Beslemeli Stok Raporu (public + kamu desteği)</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<style>
:root{
  --bg:#fbfaf6; --ink:#1f2937; --muted:#64748b; --card:#fff;
  --chip:#eef2ff; --chip-b:#e2e8f0; --shadow:0 8px 24px rgba(15,23,42,.06);
  --radius:14px; --brand-2:#faf6eb; --brand-3:#eaf4e6;
  --danger:#fee2e2; --warn:#fff7da; --ok:#ecfdf5; --info:#e0f2fe;
}
*{box-sizing:border-box}
html,body{margin:0;background:linear-gradient(180deg,var(--bg),#fff);color:var(--ink);
  font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial}
header{position:sticky;top:0;z-index:20;background:rgba(255,255,255,.9);
  backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid #eee}
.container{max-width:1200px;margin:0 auto;padding:18px 20px}
h1{font-size:18px;margin:0;font-weight:800} .note{font-size:12px;color:var(--muted)}
.topbar{display:flex;align-items:center;justify-content:space-between;gap:12px}
.right-actions{display:flex;gap:8px}
.filters{
  display:grid;grid-template-columns:repeat(6,1fr);gap:10px;margin-top:12px;
  position:relative;padding:14px;background:
    radial-gradient(1200px 200px at 20% -40%, rgba(250,246,235,.65), transparent 60%),
    radial-gradient(1200px 200px at 80% 140%, rgba(234,244,230,.55), transparent 60%),
    #fff;
  border:1px solid #eceef2;border-radius:18px;box-shadow:var(--shadow);
}
@media(max-width:1040px){.filters{grid-template-columns:repeat(3,1fr)}}
@media(max-width:640px){.filters{grid-template-columns:repeat(2,1fr)}}
.ddbox{position:relative}
.ddbox>button,.btn{
  width:100%;padding:10px 12px;border:1px solid #e6e8ec;background:linear-gradient(180deg,#fff,#fafafa);
  border-radius:12px;box-shadow:0 1px 0 rgba(15,23,42,.02), var(--shadow);
  text-align:left;cursor:pointer;transition:border-color .18s ease, box-shadow .18s ease, transform .06s ease;
}
.ddbox>button:hover,.btn:hover{box-shadow:0 12px 28px rgba(15,23,42,.08), var(--shadow);transform:translateY(-1px)}
.ddbox>button:active,.btn:active{transform:translateY(0);box-shadow:0 6px 18px rgba(15,23,42,.06)}
.ddbox>button:focus-visible,.btn:focus-visible{outline:0;box-shadow:0 0 0 3px rgba(59,130,246,.12), 0 8px 24px rgba(15,23,42,.06)}
.ddbox>button{position:relative;padding-right:36px}
.ddbox>button::after{content:'';position:absolute;right:12px;top:50%;width:8px;height:8px;margin-top:-4px;
  border-right:2px solid #94a3b8;border-bottom:2px solid #94a3b8;transform:rotate(45deg);opacity:.85;transition:.2s}
.ddbox.open>button::after{transform:rotate(-135deg);opacity:1}
.ddbox>button b{font-size:12px;letter-spacing:.02em;color:var(--muted)}
.ddbox>button .lab{font-weight:600;color:#334155}
.dd{position:absolute;left:0;top:calc(100% + 6px);z-index:10;background:#fff;border:1px solid #e5e7eb;
  border-radius:12px;box-shadow:var(--shadow);min-width:260px;max-height:320px;overflow:auto;display:none}
.ddbox.open .dd{display:block}
.dd .row{display:flex;gap:8px;align-items:center;padding:6px 8px;border-radius:8px}
.dd .row:hover{background:#f9fafb}
.ghost{border:1px solid #e5e7eb;background:linear-gradient(180deg,#f8fafc,#f3f4f6)}
.kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-top:16px}
.kpi{border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;background:linear-gradient(135deg,#fff7da,#fff)}
.kpi .title{font-size:12px;color:var(--muted);text-transform:uppercase}
.kpi .value{font-size:22px;font-weight:800}
.kpi .sub{font-size:12px;color:var(--muted)}
.tabs{display:flex;gap:8px;margin-top:18px;flex-wrap:wrap}
.tab{border-radius:12px;padding:10px 14px;background:var(--brand-2);border:1px solid #eee;font-weight:700;cursor:pointer}
.tab.active{background:var(--brand-3)}
.panel{display:none;margin-top:12px}
.panel.active{display:block}
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;margin-bottom:14px;overflow-x:visible}
.card h3{margin:0 0 10px;font-size:16px}
table{width:100%;border-collapse:separate;border-spacing:0;font-size:13px;table-layout:auto}
thead th{position:sticky;top:0;background:linear-gradient(180deg,#fff,var(--brand-2));text-align:left;
  padding:10px;border-bottom:1px solid #eee;white-space:nowrap}
tbody td,tfoot td{padding:10px;border-bottom:1px solid #f2f4f7}
tbody tr:hover{background:rgba(250,240,180,.25)}
td.num,th.num{text-align:right}
tfoot td{border-top:2px solid #e5e7eb;font-weight:700;background:#fffef7}
.badge{display:inline-flex;align-items:center;gap:6px;background:var(--chip);border:1px solid var(--chip-b);
  padding:6px 10px;border-radius:999px;font-size:12px}
.err{color:#b91c1c;background:#fee2e2;border-color:#fecaca}
.ok{color:#065f46;background:#ecfdf5;border-color:#a7f3d0}
textarea{width:100%;min-height:110px;padding:10px;border:1px solid #e5e7eb;border-radius:10px}
.small{font-size:12px;color:var(--muted)}
.ai-header{display:flex;gap:8px;align-items:center;justify-content:space-between}
.status-dot{width:8px;height:8px;border-radius:50%;background:#bbb;display:inline-block;margin-right:6px}
.status-ok{background:#10b981}.status-warn{background:#f59e0b}.status-err{background:#ef4444}
.chips{display:flex;gap:10px;flex-wrap:wrap;margin:8px 0}
.chip{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:6px 10px;border:1px solid #e5e7eb;cursor:pointer}
.chip .dot{width:8px;height:8px;border-radius:50%}
.chip[data-cat="ex"]{background:var(--danger)}
.chip[data-cat="so"]{background:var(--warn)}
.chip[data-cat="idle"]{background:#f1f5f9}
.chip[data-cat="min"],.chip[data-cat="max"]{background:#dbeafe}
.chip.active{outline:2px solid #334155}
.group{border:1px solid #e5e7eb;border-radius:10px;margin:10px 0}
.group>summary{padding:10px 12px;font-weight:700;cursor:pointer;background:#f9fafb;border-radius:10px}
.sub{margin:6px 14px;border-left:3px solid #eee;padding-left:10px}
.seg{display:inline-flex;gap:0;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;box-shadow:var(--shadow);
  background:linear-gradient(180deg,#f7faf7,#fff);padding:4px}
.seg button{padding:10px 14px;border:0;background:transparent;cursor:pointer;font-weight:700;border-radius:10px;transition:background .18s ease, box-shadow .18s ease}
.seg button:hover{filter:brightness(98%)}
.seg button.active{background:linear-gradient(180deg,var(--brand-3),#fff);box-shadow:inset 0 0 0 1px #dbe4d8, 0 6px 16px rgba(16,185,129,.06)}
@media (min-width:1041px){#modeSwitch{grid-column:6/7; grid-row:2; justify-self:end;}}
</style>
</head>
<body>
<header> ... (tam HTML içeriği, kullanıcıdan alınan kod) ... </body>
</html>
